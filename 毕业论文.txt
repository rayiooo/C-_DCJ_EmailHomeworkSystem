基于C#的C++作业管理系统设计与实现

摘要：在信息化的时代，越来越多的学习开始借助互联网这个媒介，而许多高校会采取电子版作业收发的方式进行平时作业的统计和批改。现存的作业管理系统并不完善，在功能及普适性上都有缺憾，例如，单纯通过收发邮箱汇总的方式，目前需要教师一个一个下载学生的作业以及在自己的设备上打开文件查看；而其他方式如在课堂上用U盘拷取则对于学生的作业完成时间和到场情况有严格的限制，而且容易传播病毒。另外，对于需要用其他软件打开的作业，如代码作业和工程作业等往往依赖教师进行作业查看的设备有较高的配置和软件。所以此毕业设计旨在建立一个基于电子邮箱的作业收发管理系统，能够让教师通过电子邮件直接获得学生的作业信息，而不需要下载作业后批改再新建文件进行分数统计和归纳。此系统在Windows系统上进行开发，使用C#语言在.NET平台进行作业管理系统的设计和改善，最终做出界面实现浏览学生作业、查看C++代码并在软件里编译运行、给学生评分并在最后的时候汇总分数的功能。
关键词：

Abstract：In the new age of informationization, the use of Internet is emerging in the process of learning, and many teachers in colleges tend to receive the homework of students online and correct and record each of their scores. The existing system of homework management is not perfect enough, for there are shortcomings in both function and universality. For example, if the teacher decides to get the homework of students through the existing E-mail system, he will spend most of his time downloading the homework files and open them on his local device one by one, which is apparently not efficient enough. And using other methods such as copying files through mobile divices sounds even more ridiculous under this age of Internet, and may cause the spread of virus. Therefore, this project aims to establish an e-mail-based homework management system that allows teachers to directly obtain student's homework information via e-mail without downloading any file or modifying new files for recording scores. This system is developed on the Windows system, and it uses the C# language on .NET platform for the design and improvement, and the final work should enable users to achieve functions including browsing students' assignments, view, compile and run their C++ code and summarize their scores at the end.
Key words: 

第一章 前言
1.1 选题背景和研究意义
目前，很多高校采用学生向教师发送电子版作业来完成平时作业的任务，这极大地方便了师生间的沟通和联系，且作业可以在教师端进行备份，能够很好地保存。然而，现在存在的作业收发系统仍然存在弊端。以现在最常用的邮件收发方式为例，虽然使用邮件可以让学生和老师之间的交流更加便捷，且大多数邮件都可以存储较久的时间，但是教师批阅作业时常常要经历登陆邮箱、打开邮件、下载附件、解压并打开作业文件、评分、在设备或成绩单登记成绩这样冗杂的过程，大大降低了作业的批阅效率，且本专业的大多数作业是根据作业题目编写出来的代码文件，所以还需要教师的设备上有可以运行学生代码的IDE，在批阅作业的时候逐个打开学生程序，执行编译、运行来对学生的作业进行批改审查。另外，已批阅的作业需要进行归档，如果教师在没有分类存储作业文件的情况下想要精确找到某一个同学某一次的作业，需要进行比较复杂的查找，而若是每一次都需要整理作业文件夹则需要教师花费较多时间。因此，建立一个可以打开文件并进行批阅和代码运行的编程作业管理系统能够很好地改善教师收集作业的效率和简化操作。此设计可以让教师使用邮箱的IMAP服务或POP3服务从任意邮箱获取学生发来的作业附件并批量下载到本地、分类存储，然后打开文件查看代码、编译运行并评分和统计归档。这个项目可以大大减少教师用于批改作业的准备时间和统计时间，将时间集中在批改学生作业的工作上，提高工作效率，简化工作步骤。

1.2 研究现状
目前对于基于电子邮箱的作业收发管理系统的研究有很多，都是基于不同语言与不同系统的开发研究。例如，孙永科等人使用Exim4作为其项目的邮件服务器，使用了proMail来对邮件进行过滤，使用python来编程实现作业的提取。而此设计所研究的是基于.Net平台，使用C#开发出的作业收发系统，在原理上有许多值得借鉴的内容，在实际进行开发操作时则大不一样。现在许多对于C#开发界面的研究已经比较完善，冯素梅等人和杨银见等人对于C#的使用可以为设计提供方式方法；而电子邮箱IMAP服务的相关内容也较为容易从资料中获取，另外此设计所依赖的SQLite数据库使用方法也比较成熟，唐敏等人和史永昌等人的文章中提供了较为全面的方法供后来人借鉴。而如何将以上的技术融合来完成此设计中的作业收集、测评打分、统计记录成绩等操作则是本文的主要内容。

1.3 论文组织结构
论文本论部分主要分为五个章节：第二章简要介绍毕业设计中所用到的基于.NET平台的开发及使用方式和制作出的软件所需的运行平台；第三章对于所做软件的功能和用户需求做简要分析，并对其可行性提出要求；第四章介绍软件的功能和界面设计，以及用于设计的方式方法和开发工具；第五章详细介绍模块实现程序设计，对于软件的各个功能的程序进行详细说明，主要分为邮件获取模块、附件内容读取模块、代码在线运行模块、作业文件归档模块、成绩统计模块和单次作业查找模块等6个模块进行介绍；第六章则对与软件功能的测试进行展示说明，分为功能测试和数据测试两部分。


第二章 系统相关技术及可行性分析
2.1?开发平台简介
本程序是一个主要基于.NET平台开发的应用程序。.NET平台是由微软公司搭建的一款开发平台，它提供了.NET程序运行所必须的环境，诸如.NET Framework类库以及公共语言运行时（CLR）。在Windows 98到Windows 10的一系列操作系统中，只需安装.NET Framework，就可以顺畅地运行.NET程序；而在其他操作系统如Linux、Mac OS X、Unix系统中，又可以使用Mono跨平台地实现.NET Framework编译器、CLR和基础类库，使.NET程序可以实现跨平台运行。
.NET平台可以开发出多种多样的应用程序，包括但不限于基于浏览器的应用程序、桌面应用程序、移动端应用程序、基于Unity 3D引擎的游戏开发、虚拟现实等各个方面，本程序属于桌面应用程序。.NET应用程序涵盖了两种交互模式：B/S模式和C/S模式。B/S（浏览器/服务器）模式无需用户额外安装环境和程序，只需拥有操作系统和浏览器即可使用；而C/S（客户端/服务器）模式则需要用户安装.NET环境和应用程序。本程序采用C/S模式。
微软提供了对.NET平台的多种编程语言支持，如C++、VB、C#、F#等编程语言，而本程序则使用C#进行开发，它拥有简洁、现代、面向对象、类型安全、垃圾自动回收等特性，比较适合Windows操作系统的应用程序开发。工欲善其事、必先利其器，我们在此使用微软发布的Visual Studio集成开发环境进行开发，使用Git进行版本控制，更有效率地进行开发工作，完成整个软件生命周期中的各项工作。

2.2?软件运行平台
C#编写出的应用程序必须运行在.NET平台上。软件面向的用户主要是Windows操作系统用户，因此只要在Windows操作系统上安装与程序相对应版本的.NET Framework即可运行环境，本程序基于.NET Framework 4.6.1进行开发。而如果要运行在其他操作系统上，则需要安装Mono项目，以实现.NET运行环境的跨平台支持。另外，为了实现对C++作业文件的编译，用户还需安装Visual C++，并将VC自带的cl编译器配置到系统环境变量中。

2.3 可行性分析
2.3.1 经济可行性
本系统开发成本较低，无需额外的经济投资。完成后可以为计算机系教师批阅程序代码节省大量的繁杂步骤和时间，提高作业批阅效率，节省出的时间可用于提升教师授课水平和进行科研项目，具有较高的收益/投资比。

2.3.2 技术可行性
通过大学期间编程语言和各方面理论的学习，以及对C#语言的了解和掌握，该系统从技术方面考虑可以顺利完成。

2.3.3 法律可行性
系统开发均为原创内容，使用到的开源项目均遵守其开源协议，不构成侵权、违法等责任。

2.3.4 用户使用可行性
用户使用主体为大学计算机专业的教师，尤其是C++相关课程的教师。教师只需通知学生按照规定要求向老师邮箱发送程序代码作业，即可使用本软件收取作业进行批阅，并在期末自动统计作业分数、生成成绩表格，方便教师使用。


第三章 需求分析
3.1 功能需求分析
开发软件前，首先要考虑的就是用户对于软件的功能需求，需要开发者详细了解软件设计的每一个功能需求并做整体设计。若是过分执着于开发者所认为的某些单一方面，而忽略了其他方面，就可能导致系统设计不周，增加工作量，也可能导致用户使用时无法体验到最佳的功能；若是每一个细微的点和面都要详细进行设计，则对与开发者来说是一项巨大的繁琐的工程，短期内开发者无法兼顾所有开发需求。所以一般采取先对整体进行较为全面的大致设计，再对细节进行编写；先解决主要矛盾，再进行后续的优化、更新和适配性改善的方法。这里我们就用户所需要解决的主要问题和希望获取的主要功能进行需求分析。

3.1.1 读取附件内容并解压、分类储存
目前可用的电子邮箱系统对于word、excel和powerpoint等常用的文档格式的文件可以在线浏览，因此对于普通学科的教师来说，使用电子邮件收取文档格式的作业并进行批阅是较为容易的。然而，对于计算机专业的许多专业课来说，知识的切身实践和应用才是教师希望学生最终能够掌握的，所以学生的作业常常以程序代码文件的形式提交，需要老师手动编译运行才能验证程序的正确性。这里以C++代码文件为例：教师往往需要先下载学生的项目压缩文件到自己的电脑上，然后解压至指定文件夹，并打开代码编辑器才能看到学生的代码，而编译和运行代码又需要更多的时间。教师在浏览完一位学生的程序代码作业之后，需要再重新打开下一位同学的作业文件进行上述重复的操作。而即便是学生的作业通过集中汇总的方式提交，教师仍需要重复打开文件夹进行操作；而若学生不是集体提交作业时，教师还需要重新从下载这一步做起，十分的耗时和费力。所以建立一个可以在线读取C++项目文件的作业批改系统是非常必要的，这个系统应当支持自动地从教师邮箱中提取学生作业并下载、分类、整理，实现在系统中直接阅读C++文件中的代码，并能够在系统中编译和运行，这样教师才能够更方便地批阅通过电子邮件收取的C++代码作业。

3.1.2 作业浏览
在当前现状下，教师如需审阅C++作业，首先就要在作业总文件夹下定位每一位学生的某次作业文件夹，打开后还需将作业载入集成开发环境才能够看到作业代码。这样会使大量时间被消耗在寻找作业文件路径上，十分不方便。另外，哪些作业批改过，哪些作业有待批改，还需要老师手动查阅作业成绩单；如果有学生某次作业没有提交，就又要费一番功夫。因此，作业批阅系统应该支持对作业文件夹按学生、按作业次数、按学生是否提交、按作业是否批改进行分类，以便实现对作业的快捷管理。

3.1.3 在管理系统中直接编译、运行程序
教师在批改较为简单的代码作业时，可以单纯凭借观看代码的方式来判断学生的作业是否合格，但大多数情况下，教师需要在自己的电脑上使用各种IDE如Dev-C++、Visual Studio、CodeBlocks等集成开发环境对C++代码进行编译，并在生成的可执行文件中测试学生的作业程序是否能正常输出、输出结果是否正确，并评判程序的鲁棒性和时间复杂性能否合格等等。对于需要运行代码的作业来说，程序运行系统构建出来会减轻很大一部分工作量，所以能够在管理系统中直接编译和运行程序也是这项毕业设计项目的非常重要的一项功能需求。

3.1.4 评分系统


第四章 软件的设计
4.1 软件操作界面设计

4.2 功能模块设计

参照 https://wenku.baidu.com/view/332d79ec68dc5022aaea998fcc22bcd127ff4262.html

第五章 模块实现程序设计
5.1 邮件获取模块

5.2 附件内容读取模块

5.3 C++代码在线运行模块

5.4 作业文件归类模块

5.5 成绩统计模块

5.6 作业查找模块


第六章 软件测试
6.1 功能测试
6.1.1 读取邮件及获取附件

6.1.2 作业代码在线运行

6.1.3 打分及归档

6.2 数据测试


结论

参考文献
孙永科, and 王小林. "基于E-mail的电子作业管理系统." 电脑知识与技术：学术交流 2(2013):805-806.
秦新国. 电子作业管理和作业抄袭检测技术研究. Diss. 南京师范大学, 2007.
章立民研究室. Visual C#2005程序开发外界面设计秘诀. 机械工业出版社, 2006.
郑小平. Visual C#.NET开发实践. 人民邮电出版社, 2001.
冯素梅. "基于C#的打字测试软件研究与开发." 现代计算机(专业版) 11(2008):118-120.
杨银见. "用Visual C#实现监视文件和文件夹系统变化." 陕西气象 6(2005):32-33.
马可君. 基于.Net网络文件存储管理系统设计与实现. Diss. 电子科技大学.
王水. "基于自由软件的面向Web的IMAP电子邮件服务." 微型机与应用 19.10(2000):58-60.
YongZi. "使用IMAP协议收发邮件." 大众软件 22(2008):66-67.
魏志敏. "电子邮件IMAP4服务介绍." 科技信息 2(2000):39-39.
高祥. "从POP3到IMAP." 计算机与网络 19(2000):22-22.
番茄蛋挞. "指定IMAP邮箱目录收取邮件全文." 电脑迷 2(2010):72-72.
田昊. "基于Win32开发的Visual Studio C/C++编译器的提取和使用." 电脑编程技巧与维护 17(2015):13-15.
唐敏, and 宋杰. "嵌入式数据库SQLite的原理与应用." 电脑知识与技术：学术交流 2(2008):600-603.
 Yun, Ling , and  L. Jun . "The Development and Application of Script Program Based on Sqlite." 2007北京地区高校研究生学术交流会通信与信息技术会议论文集（上册） 2008.
史永昌, and 王永乐. "基于SQLite的嵌入式数据库研究与应用." 福建电脑 24.8(2008):151-151.
 Draheim, Dirk ,  C. Lutteroth , and  G. Weber . "Generative programming for C#." ACM SIGPLAN Notices 40.8(2005):29.
 
谢辞
在这篇毕业论文和这项毕业设计完成的过程中，有许多亲友、师长提供了帮助。尤其感谢钟凡老师对此毕业设计的指导和帮助。
附录
毕业设计代码：

外文原文

中文翻译
